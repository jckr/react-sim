{"version":3,"sources":["webpack:///./src/components/examples/chaos-game.js","webpack:///./src/pages/examples/chaos-game.mdx","webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.string.repeat.js","webpack:///./node_modules/gatsby/node_modules/core-js/modules/_string-repeat.js"],"names":["Model","props","sx","border","p","width","updateAttractors","angleOffset","nbAttractors","height","center","radius","Math","min","Array","keys","map","i","angle","x","cos","PI","y","sin","init","undefined","random","attractors","o","background","floor","color","points","prevDirection","updateData","data","params","tick","length","rules","split","reduce","prev","curr","push","direction","lastPoint","attractor","newPoint","draw","ctx","circle","globalAlpha","fillStyle","globalCompositeOperation","fillRect","point","r","fill","BasicChaosGame","ticksPerAnimation","maxTime","initData","isPlaying","loop","initialParams","Controls","withControls","setParams","nbToggles","nbRows","ceil","toggle","a","key","flex","checked","charAt","label","setValue","bit","updatedRules","slice","toggles","flexDirection","justifyContent","minValue","maxValue","value","v","repeat","ChaosGame","withFrame","canvasRef","useRef","useEffect","current","getContext","beginPath","arc","ref","_frontmatter","layoutProps","MDXContent","components","mdxType","parentName","isMDXComponent","$export","P","toInteger","defined","module","exports","count","str","String","this","res","n","Infinity","RangeError"],"mappings":"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","file":"component---src-pages-examples-chaos-game-mdx-ab81b5883bddba6917a3.js","sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport {\n  Model as RawModel,\n  withControls,\n  withFrame,\n  Range,\n  Toggle,\n  Timer,\n  CanvasFrame,\n} from 'react-sim';\nimport { Flex } from 'rebass';\n\nconst Model = props => (\n  <Flex sx={{ border: '1px solid #000', p: 2, width: 'fit-content' }}>\n    <RawModel {...props} />\n  </Flex>\n);\n\nconst updateAttractors = ({ angleOffset, nbAttractors, height, width }) => {\n  const center = { x: width / 2, y: height / 2 };\n  const radius = (0.95 * Math.min(height, width)) / 2;\n  return [...Array(nbAttractors).keys()].map(i => {\n    const angle = angleOffset + (0.5 * (nbAttractors + 4 * i)) / nbAttractors;\n    return {\n      x: center.x + radius * Math.cos(angle * Math.PI),\n      y: center.y - radius * Math.sin(angle * Math.PI),\n    };\n  });\n};\n\nfunction init({ angle, nbAttractors, height, width }) {\n  const angleOffset = angle === undefined ? Math.random() * 2 * Math.PI : angle;\n  const attractors = updateAttractors({\n    angleOffset,\n    nbAttractors,\n    height,\n    width,\n  });\n  const o = {\n    x: Math.random() * width,\n    y: Math.random() * height,\n  };\n  const background = `hsla(${Math.floor(Math.random() * 360)}, 30%, 7%, 1)`;\n  const color = `hsla(${Math.floor(Math.random() * 360)}, 77%, 45%, 1)`;\n  return {\n    attractors,\n    background,\n    color,\n    points: [o],\n    prevDirection: 0,\n  };\n}\n\nfunction updateData({ data, params, tick }) {\n  const { nbAttractors } = params;\n  if (data.attractors.length !== nbAttractors) {\n    data.attractors = updateAttractors(params);\n  }\n  const rules = params.rules\n    ? params.rules.split('').reduce((prev, curr, i) => {\n        if (curr === '1') {\n          prev.push(i);\n        }\n        return prev;\n      }, [])\n    : [...Array(nbAttractors).keys()];\n  const direction =\n    (data.prevDirection + rules[Math.floor(Math.random() * rules.length)]) %\n    nbAttractors;\n  data.prevDirection = direction;\n  const lastPoint = data.points[data.points.length - 1];\n  const attractor = data.attractors[direction];\n  const newPoint = {\n    x: (lastPoint.x + attractor.x) / 2,\n    y: (lastPoint.y + attractor.y) / 2,\n  };\n  data.points.push(newPoint);\n  return data;\n}\n\nconst Frame = ({ data, tick, params }) => {\n  const canvasRef = useRef(null);\n  const { height, width } = params;\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    ctx.globalAlpha = 1;\n    ctx.fillStyle = data.background;\n    ctx.globalCompositeOperation = 'source-over';\n    ctx.fillRect(0, 0, width, height);\n\n    ctx.globalCompositeOperation = 'lighter';\n    ctx.fillStyle = data.color;\n\n    for (let i = 0; i < tick; i++) {\n      ctx.globalAlpha = 0.8;\n      const point = data.points[i];\n      ctx.beginPath();\n      ctx.arc(point.x, point.y, params.r, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  });\n  return <canvas height={height} width={width} ref={canvasRef} />;\n};\n\nfunction draw({ ctx, data, params, tick, circle }) {\n  const { height, width } = params;\n  ctx.globalAlpha = 1;\n  ctx.fillStyle = data.background;\n  ctx.globalCompositeOperation = 'source-over';\n  ctx.fillRect(0, 0, width, height);\n\n  ctx.globalCompositeOperation = 'lighter';\n  ctx.fillStyle = data.color;\n  ctx.globalAlpha = 0.8;\n\n  for (let i = 0; i < tick; i++) {\n    const point = data.points[i];\n    const { x, y } = point;\n    const { r } = params;\n    circle({ x, y, r });\n    ctx.fill();\n  }\n}\n\nconst ChaosFrame = props => <CanvasFrame draw={draw} {...props} />;\n\nexport const BasicChaosGame = () => (\n  <Model\n    ticksPerAnimation={100}\n    maxTime={10000}\n    initData={init}\n    isPlaying\n    loop\n    updateData={updateData}\n    initialParams={{\n      height: 500,\n      width: 500,\n      nbAttractors: 3,\n      r: 1,\n    }}\n  >\n    <CanvasFrame draw={draw} />\n  </Model>\n);\n\nconst CustomControls = ({ params, setParams }) => {\n  const nbToggles = params.nbAttractors;\n  const nbRows = Math.ceil(nbToggles / 5);\n  const toggle = a =>\n    a < nbToggles ? (\n      <Toggle\n        key={`toggle-${a}`}\n        sx={{ flex: '1 1 0' }}\n        checked={params.rules.charAt(a) === '1'}\n        label={`${a + 1}${a === 0 ? 'st' : a === 1 ? 'nd' : 'th'} vertex`}\n        setValue={checked => {\n          const bit = params.rules.charAt(a) === '1' ? '0' : '1';\n          const updatedRules =\n            params.rules.slice(0, a) + bit + params.rules.slice(a + 1);\n          setParams({ rules: updatedRules });\n        }}\n      />\n    ) : null;\n\n  const toggles = [...Array(nbRows).keys()].map(r => (\n    <Flex\n      flexDirection=\"row\"\n      key={`tr-${r}`}\n      sx={{ justifyContent: 'space-between' }}\n    >\n      {[r * 5, r * 5 + 1, r * 5 + 2, r * 5 + 3, r * 5 + 4].map(toggle)}\n    </Flex>\n  ));\n\n  return (\n    <Flex flexDirection=\"column\">\n      <Range\n        key=\"range\"\n        minValue={3}\n        maxValue={20}\n        label=\"Vertices\"\n        value={params.nbAttractors}\n        setValue={v =>\n          setParams({ nbAttractors: v, rules: '1'.repeat(v) }, true)\n        }\n      />\n      <Flex flexDirection=\"column\">{toggles}</Flex>\n    </Flex>\n  );\n};\n\nconst Controls = withControls(CustomControls);\nconst HOCFrame = withFrame(Frame);\nexport const ChaosGame = () => (\n  <Model\n    ticksPerAnimation={100}\n    maxTime={20000}\n    initData={init}\n    updateData={updateData}\n    initialParams={{\n      height: 500,\n      width: 500,\n      nbAttractors: 7,\n      angle: 0,\n      r: 1,\n      rules: '1001100',\n    }}\n  >\n    <Flex flexDirection=\"column\">\n      <CanvasFrame draw={draw} />\n      <Controls />\n    </Flex>\n  </Model>\n);\n","import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport { BasicChaosGame, ChaosGame } from '../../components/examples/chaos-game';\nexport const _frontmatter = {\n  \"Title\": \"Chaos Game\"\n};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\";\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n    <h1>{`Chaos Game`}</h1>\n    <BasicChaosGame mdxType=\"BasicChaosGame\" />\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://en.wikipedia.org/wiki/Chaos_game\"\n      }}>{`Chaos Game`}</a>{` is a method to generate a fractal.`}</p>\n    <p>{`We start from an equilateral triangle, and one point chosen at random in the plane.\nAt each iteration, we plot a new point which is halfway between the previous point, and one of the vertices of the triangle, chosen at random.\nWe continue plot points like these.`}</p>\n    <p>{`Eventually, our figure looks like the `}<a parentName=\"p\" {...{\n        \"href\": \"https://en.wikipedia.org/wiki/Sierpi%C5%84ski_triangle\"\n      }}>{`Sierpiński triangle`}</a></p>\n    <ChaosGame mdxType=\"ChaosGame\" />\n    <p>{`But we can generalize this to other polygons.\nIn this second version, we can choose a regular polygon with 3 to 12 vertices (so, anything from a triangle to a dodecagon).\nWe can also choose whether we use each vertex as an attractor or not. If a vertex is not an attractor, it won't be used to compute the position of new points in iterations.`}</p>\n    <p>{`For larger polygons, if all vertices are used as attractors, the resulting figure looks a bit messy. But if we only pick a few, then shapes will start to emerge.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","var $export = require('./_export');\n\n$export($export.P, 'String', {\n  // 21.1.3.13 String.prototype.repeat(count)\n  repeat: require('./_string-repeat')\n});\n","'use strict';\nvar toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n\nmodule.exports = function repeat(count) {\n  var str = String(defined(this));\n  var res = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError(\"Count can't be negative\");\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;\n  return res;\n};\n"],"sourceRoot":""}